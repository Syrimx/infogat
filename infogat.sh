#!/bin/bash

# maybe implement caching features
# maybe implement report export functionality

# {Eye Candy}
echo "
   _      ___               __ 
  (_)__  / _/__  ___ ____ _/ /_
 / / _ \/ _/ _ \/ _ `/ _ `/ __/
/_/_//_/_/ \___/\_, /\_,_/\__/ 
               /___/           

"
echo "[*] build by ely sylvain schybol"
echo "

                                            .........                                          
                                           ...%...%...                                         
                               .....       ..%.. ..%..      ......                             
                             ...%%=...     .%-:..:-=-..   ....#%%...                           
                             ..%...%:.....:+%%%%%%%%%=......#=...#..                           
                     .....   ..%....#%#==-================%%*....%..    ...                    
                   ...+:.......%%*=============================#%%.......==..                  
                   .*....%..%%====================================-%+.+%...#.                  
                   .*:...*%============%=================*============%-...+.                  
                   ..%-%===============*================#===============##-%.                  
                   ..%=================-%===============%=================*#... .....          
          .........**===================+==============%-===================%.........         
          .*#..:%%%======================%============*+======================%%....%..        
          .*.....%=====-*=================%-=========#==================#======%....%..        
         ..%----%========%=====##================================%====*#========%--#:..        
         ...%--%===========%%=%..%==========%%#==+%%%-=========#-..*%*==========-%%....        
          ....%==============#....#+=====#-============*======%....%=============+-..          
           ...*==============%......%+=====================++#.....-*=============%..          
          ...%==============-#..  ...#+====================%......::#=============+*...        
      .......*===============%-:..  ...%#================%:......---*=============+%.......    
    ...%+...%++==============#----......%================#.....----%==============+*:...%%...  
    ..%.....%++===============%-------+#==================%-------#==============+++#....:+..  
    ..:#----%+++==%%%%**=====+=%---+%*=====================-%#---%=+====+*#%%%#==+++%----%...  
      ..#%--%++++==========++======================================++==========+++++%--%:..    
      .....:%+++++++======+++======%..%==================*#.-%======+++======+++++++%......    
          ..%+++++++++++++++-=====%...%%-=====+#.%======#%%..:*=====-+++++++++++++++*..        
           .=++++++++++++%========%..%=%%====*=...%=====%%:%..%=======+%+++++++++++#..         
          ...%+++++++++++*+==%-===%..*.%%===-*.. ..%====%%.%..%===-*==+%+++++++++++%..         
          ..%.%++++++++++%+++#+-==*:.%%%%===%..  ...%==-%%%%.#-===*++++%++++++++++%.%..        
         ..%..-%++++++++++%++%++===%:#%%-==%..     .====*%%.#+===++*+*#++++++++++%-..%..       
         ..%.----%++++++++++%%++======-====*..     ..%=====-=====++%#+++++++++#%----.%..       
          ..........-%%%%%%%%*++==========%-.... ...::#==========++%%%%%%%%%:..........        
            .............%=++#++==========%----..:----*==========++%++==... .   .....          
                       ..#==+*#+++=====%#=+%---------%+=%%=====+++%++=*..                      
                       ...*=+++%++++++===-=+%=-----*#+====++++++*%+++=%...                     
                       ...%==++++*%#*+++++==+++##*+++==+++++*%%+++++=-#...                     
                       ...=+=++++++%+++%#+++++++++++++++%%++%++++++==%...                      
                   .....-%+%==++++++#*++++*%#+++++++%%+++++%+++++++==%*%.....                  
            .... .....%+==++*==+++++++#%++++++++++++++++*%++++++++==%++==#%....  ...           
           ..++....=%=====++%===+++++++++*%%#++++++*%%#++++++++++===*++=====%.....*..          
           ..:*=+%%======++++%===+++++++++++++++%+++++++++++++++===%++++======%%==%..          
           ...%=======-++++++*+===++++++++++++++%++++++++++++++===%+++++++========#..          
           ...:*====++++++++++%-===+++++++++++++%+++++++++++++===+++++++++++=====%..           
             ..%+++++++++++++++%====++++++++++++%++++++++++++===-%++++++++++++++++.            
             ...%+++++++++++++++%===++++++++++++%+++++++++++====%+++++++++++++++%..            
              ...#+++++++++++++++%===+++++++++++%+++++++++++===%+++++++++++++++%...            
               ...%++*%%%%#=.....%===+++++++++++%+++++++++++===%.....+%%%%#*++%..              
                 .......       .#####%%%%%%#+:.....:*%%%%%%%###%:.      .........              
                               ...........             ...........                             



"

# {Error Handling}
if [[ $# < 2 || "$1" =~ "--" ]];then
	echo $'[*] Please provide a flag and an IP adresse/domain to enjoy the features...\n[*] ./infogat.sh 10.11.12.13 --<flag1> --<flag2>\n[*] Flags: [--help, --basic, --smb, --ftp]'
	exit 1
fi

# {Preparation}
# check if a reporting folder exists and creating one if it doesn't
if [ ! -d ./reports ];then
	echo "[*] creating reporting folder... ./reports"
	mkdir ./reports
fi

# check if commands are missing and install them if they do
#if ! command -v <the_command>  > /dev/null
#then
#    echo "<the_command> could not be found"
#    exit 1
#fi

# main functionalities
if [[ "$*" == *"--basic"* ]];then
	echo "[*] starting port scanning..."
	sudo nmap $1 -p- -oN "./reports/$1_basicScan"  
	sudo nmap $1 -sC -sV -p- --min-rate 5000 -oN "./reports/$1_advancedScan"  

	if [[ $(curl -s $1) ]];then
		echo "[*] starting directory fuzzing..."
		gobuster dir -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -u $1 -o "./reports/$1_dirGoFuzz" -b 404,503,500  
		dirsearch -u $1 -o "./reports/$1_dirSearchFuzz" -x 500,503,404  

		echo "[*] starting subdomain enumeration..."
		gobuster dns -w /usr/share/wordlists/SecLists/DNS/subdomains-top1million-110000.txt -d $1 -o "./reports/$1_subList"  
	fi

	echo "[*] vulnerability scanning..."
	nikto -h $1 > "./reports/$1_niktoVuln"  
	sudo nmap --script "vuln" $1 -oN "./reports/$1_nmapVuln"  
fi

#<tba> --ftp --smb --install

exit 0;